#include <iostream>
#include <algorithm>
#include <queue>
#include <stack>
#include <map>
#include <unordered_map>
#include <unordered_set>
#include <vector>
using namespace std;
struct trie
{
    trie *link[26]={nullptr};

    bool flag=false;
    bool contains_key(char ch){
        return link[ch-'a']!=nullptr;
    }
    int word_count=0;
    int prefix_count=0;
    trie*get_reference_node(char ch){
        return link[ch-'a'];
    }
    void put_char(char ch,trie*node){
        link[ch-'a']=node;
    }
    void set_end(){
        flag=true;
    }
    void increase_word_count(){
        word_count++;
    }
      void decrese_word_count(){
        word_count--;
    }
    void increase_prefix_count(){
        prefix_count++;
    }
    void decrease_prefix_count(){
        prefix_count--;
    }
};
trie *root=new trie();
void insert(string s){
    int n=s.size();
     trie*node=root;
    for(int i=0;i<n;i++){
      
 if(!node->contains_key(s[i])){
  
  node->put_char(s[i],new trie());
  
 
 }
 node->increase_prefix_count();
  node=node->get_reference_node(s[i]);
    }
    node->increase_word_count();
    node->set_end();
}


int word_cnt(string word){
    trie*node=root;
    int n=word.size();
    int flag=1;
    for(int i=0;i<n;i++){
        if(!node->contains_key(word[i])){
            flag=0;
           cout<<"Word is not present !"<<endl;
           break;
        }
        else{
            trie*reference_node=node->get_reference_node(word[i]);
  node->increase_prefix_count();
  node=reference_node;
        }
    }
    if(flag==1){
        return node->word_count;
    }
}
int prefix_cnt(string prefix){
    trie*node=root;
    int n=prefix.size();
    int flag=1;
    for(int i=0;i<n;i++){
        if(!node->contains_key(prefix[i])){
            flag=0;
           cout<<"Prefix is not present !"<<endl;
           break;
        }
        else{
            trie*reference_node=node->get_reference_node(prefix[i]);
 
  node=reference_node;
        }
    }
    if(flag==1){
        return node->prefix_count;
    }
}
void erase(string prefix){
      trie*node=root;
    int n=prefix.size();
    int flag=1;
    for(int i=0;i<n;i++){
        if(!node->contains_key(prefix[i])){
            flag=0;
           cout<<"Prefix is not present !"<<endl;
           break;
        }
        else{
            trie*reference_node=node->get_reference_node(prefix[i]);

  node=reference_node;
        }
    }
    if(flag==1){
      node->decrese_word_count();
    }
}
int main()
{
    int n;
    cout << "Enter the dimension : ";
    cin >> n;
   cout<<"Enter the words : ";
    vector<string> words(n);
    for (int i = 0; i < n; i++)
    {
        cin >> words[i];
    }
    for(int i=0;i<n;i++){
        insert(words[i]);
    }
    int x;
    cout<<"Enter trials : ";
    cin>>x;
    while(x--){
    string word;
    cout<<"Enter words to find number of its occurances : ";
    cin>>word;
    cout<<"Occurances : "<<word_cnt(word)<<endl;

    string prefix;
    cout<<"Enter prefix to find number of occuraces : ";
    cin>>prefix;
    cout<<"Occurances : "<<prefix_cnt(prefix)<<endl;
    string word_erased;
    cout<<"Enter the word to be erased : ";
    cin>>word_erased;
    erase(word_erased);
    cout<<"Number of occurances of "<<word_erased<<" : "<<word_cnt(word_erased)<<endl;


}
}
